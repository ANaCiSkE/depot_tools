{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "2e6508d8_2d510430",
        "filename": "presubmit_support.py",
        "patchSetId": 3
      },
      "lineNbr": 1829,
      "author": {
        "id": 1147264
      },
      "writtenOn": "2024-08-12T20:52:58Z",
      "side": 1,
      "message": "nit; it may feel more comfortable if the event object is passed as an argument.\n\n```\ndef _progress_loop(event):\n  ...\n\nevent \u003d threading.Event()\nevent_thread \u003d threading.Thread(target\u003d_progress_loop, args\u003d(event,))\n```",
      "range": {
        "startLine": 1821,
        "startChar": 8,
        "endLine": 1829,
        "endChar": 62
      },
      "revId": "3bdb1bd4b9b5db154fbc22431fe49f7df39b6031",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d5f99293_be29fdb8",
        "filename": "presubmit_support.py",
        "patchSetId": 3
      },
      "lineNbr": 1829,
      "author": {
        "id": 1367998
      },
      "writtenOn": "2024-08-12T21:15:41Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "2e6508d8_2d510430",
      "range": {
        "startLine": 1821,
        "startChar": 8,
        "endLine": 1829,
        "endChar": 62
      },
      "revId": "3bdb1bd4b9b5db154fbc22431fe49f7df39b6031",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e4001128_d65e2122",
        "filename": "presubmit_support.py",
        "patchSetId": 3
      },
      "lineNbr": 1844,
      "author": {
        "id": 1147264
      },
      "writtenOn": "2024-08-12T20:52:58Z",
      "side": 1,
      "message": "Let\u0027s wait for the thread to terminate just for clean finish.\n\n```\nevent.set()\nevent_thread.join()\n```",
      "range": {
        "startLine": 1844,
        "startChar": 12,
        "endLine": 1844,
        "endChar": 23
      },
      "fixSuggestions": [
        {
          "fixId": "c102fde4_241c90ec",
          "description": "prompt_to_edit API",
          "replacements": [
            {
              "path": "presubmit_support.py",
              "range": {
                "startLine": 1845,
                "startChar": 0,
                "endLine": 1845,
                "endChar": 0
              },
              "replacement": "            event_thread.join()\n"
            }
          ]
        }
      ],
      "revId": "3bdb1bd4b9b5db154fbc22431fe49f7df39b6031",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "17d9ba2f_17ce4d5b",
        "filename": "presubmit_support.py",
        "patchSetId": 3
      },
      "lineNbr": 1844,
      "author": {
        "id": 1367998
      },
      "writtenOn": "2024-08-12T21:15:41Z",
      "side": 1,
      "message": "This shouldn\u0027t be necessary right? Since this thread doesn\u0027t affect the main thread and `_progress_loop` will always terminate after `.set()`",
      "parentUuid": "e4001128_d65e2122",
      "range": {
        "startLine": 1844,
        "startChar": 12,
        "endLine": 1844,
        "endChar": 23
      },
      "revId": "3bdb1bd4b9b5db154fbc22431fe49f7df39b6031",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fd6de577_2bd11964",
        "filename": "presubmit_support.py",
        "patchSetId": 3
      },
      "lineNbr": 1844,
      "author": {
        "id": 1147264
      },
      "writtenOn": "2024-08-12T21:29:55Z",
      "side": 1,
      "message": "I highly believe that Event() is just a pthread conditional variable. So, calling event.set() wouldn\u0027t guarantee that the thread is awaken at the time of event.set() return. It just signals the thread(s) to wake up, and it\u0027s up to OS to schedule execution of the background thread.\n\nBy having event_thread.join(), it effectively ensures that it waits until\n- the thread gets awaken\n- _progress_loop() returns, and\n- the thread exists.\n\nThat said, you are right that OS will probably schedule execution of the background thread within a reasonable time frame, so that it\u0027s not a big deal not to wait for the thread termination within the main thread. Please make your call. ðŸ˜Š",
      "parentUuid": "17d9ba2f_17ce4d5b",
      "range": {
        "startLine": 1844,
        "startChar": 12,
        "endLine": 1844,
        "endChar": 23
      },
      "revId": "3bdb1bd4b9b5db154fbc22431fe49f7df39b6031",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c4b5ba59_a03ea4d3",
        "filename": "presubmit_support.py",
        "patchSetId": 3
      },
      "lineNbr": 1844,
      "author": {
        "id": 1367998
      },
      "writtenOn": "2024-08-12T22:06:26Z",
      "side": 1,
      "message": "Thanks for explaining, I\u0027ll add it just to be safe.",
      "parentUuid": "fd6de577_2bd11964",
      "range": {
        "startLine": 1844,
        "startChar": 12,
        "endLine": 1844,
        "endChar": 23
      },
      "revId": "3bdb1bd4b9b5db154fbc22431fe49f7df39b6031",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}