#!/usr/bin/env vpython3

# -*- coding: utf-8 -*-
import os
import re
import subprocess
import sys


def main(argv):
    # Assume the second arg is the file.
    with open(argv[1], 'r') as f:
        if 'python3' in f.readline():
            vpython = 'vpython3'
        else:
            vpython = 'vpython'
    yapf_runner = os.path.join(os.path.dirname(__file__), 'yapf_runner.py')
    # Use either vpython or vpython3 to run yapf.py. Return its returncode so
    # that the caller can choose how to handle failures.
    return subprocess.run([vpython, yapf_runner] + argv[1:]).returncode


if __name__ == '__main__':
    sys.exit(main(sys.argv))
