{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "0be27829_0f4d79f4",
        "filename": "recipes/recipe_modules/depot_tools/api.py",
        "patchSetId": 1
      },
      "lineNbr": 56,
      "author": {
        "id": 1114919
      },
      "writtenOn": "2021-01-25T12:31:10Z",
      "side": 1,
      "message": "This might not be the best long term way to use `dirmd`, since it couples your recipes (ran on bots) to depot_tools (a kitchensink of tools thrown into developer\u0027s $PATH). This may be OK though -- hard to say w/o knowing your intended usage.\n\nDo you have a CL with expected usage? have you tested that CL with `led` tooL?\n\nAlso, I suspect you also need to modify .gitattributes to ensure dirmd entry shim is included:\nhttps://chromium.googlesource.com/chromium/tools/depot_tools/+/05ee22c63669f86e673b1f396e7d91c29ef2af7e/.gitattributes",
      "revId": "05ee22c63669f86e673b1f396e7d91c29ef2af7e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d4e9e58a_7ddd6812",
        "filename": "recipes/recipe_modules/depot_tools/api.py",
        "patchSetId": 1
      },
      "lineNbr": 56,
      "author": {
        "id": 1241393
      },
      "writtenOn": "2021-01-25T21:29:39Z",
      "side": 1,
      "message": "Yes, this is for CLs https://chrome-internal-review.googlesource.com/c/chrome/tools/build_limited/scripts/slave/+/3552844 and https://chromium-review.googlesource.com/c/chromium/src/+/2645158\n\nCould you look at them and see if that\u0027s appropriate or if there\u0027s another way to invoke dirmd from the builders?\n\nI can\u0027t use led at the moment due to crbug.com/1168315, but I\u0027ll run it before landing.\n\nIf I need to include the .gitattributes change, a led run would fail, right?",
      "parentUuid": "0be27829_0f4d79f4",
      "revId": "05ee22c63669f86e673b1f396e7d91c29ef2af7e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9e4b263c_ed4624be",
        "filename": "recipes/recipe_modules/depot_tools/api.py",
        "patchSetId": 1
      },
      "lineNbr": 56,
      "author": {
        "id": 1114919
      },
      "writtenOn": "2021-01-25T21:56:25Z",
      "side": 1,
      "message": "\u003e Yes, this is for CLs https://chrome-internal-review.googlesource.com/c/chrome/tools/build_limited/scripts/slave/+/3552844 and https://chromium-review.googlesource.com/c/chromium/src/+/2645158\n\u003e \n\u003e Could you look at them and see if that\u0027s appropriate or if there\u0027s another way to invoke dirmd from the builders?\n\nIn general, one should bring the binaries you depend on. Depot_tools is a kitchensink, originally meant for manually-ran commands, not something with stability. I\u0027ve asked the question from martiniss@ on chromium/src CL.\n\n\u003e I can\u0027t use led at the moment due to crbug.com/1168315, but I\u0027ll run it before landing.\n\nhttps://crbug.com/1168315 was filed in generic \"Infra\" component. I\u0027ve triaged it to my team to see what\u0027s up.\n\n\u003e If I need to include the .gitattributes change, a led run would fail, right?\nYes, resulting build should fail with smth like dirmd not found.",
      "parentUuid": "d4e9e58a_7ddd6812",
      "revId": "05ee22c63669f86e673b1f396e7d91c29ef2af7e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "924cfb88_eebb65c5",
        "filename": "recipes/recipe_modules/depot_tools/api.py",
        "patchSetId": 1
      },
      "lineNbr": 56,
      "author": {
        "id": 1241393
      },
      "writtenOn": "2021-01-28T22:12:42Z",
      "side": 1,
      "message": "How do I patch this CL into a led run? I ran:\n\n@ /usr/local/google/code/clankium/src (touchresources)$ led get-builder luci.chrome.ci:lorenz-graph-dbg | led edit-recipe-bundle | led edit-cr-cl https://chromium-review.googlesource.com/c/chromium/tools/depot_tools/+/2644827 | led edit -d pool\u003dluci.chrome.try | sed s/chrome-ci-builder/chrome-try-builder/g | led edit -experiment luci.use_realms\u003dfalse | led launch\n\nBut it doesn\u0027t seem like it was patched (tried even with .gitattributes though it didn\u0027t look like the problem):\n\n The recipe has crashed at point \u0027Uncaught exception\u0027!\n Traceback (most recent call last):\n   File \"/b/s/w/ir/kitchen-checkout/recipe_engine/recipe_engine/internal/engine.py\", line 571, in run_steps\n     raw_result \u003d recipe_obj.run_steps(api, engine)\n   File \"/b/s/w/ir/kitchen-checkout/recipe_engine/recipe_engine/internal/recipe_deps.py\", line 832, in run_steps\n     properties_def, api\u003dapi)\n   File \"/b/s/w/ir/kitchen-checkout/recipe_engine/recipe_engine/internal/property_invoker.py\", line 89, in invoke_with_properties\n     arg_names, **additional_args)\n   File \"/b/s/w/ir/kitchen-checkout/recipe_engine/recipe_engine/internal/property_invoker.py\", line 52, in _invoke_with_properties\n     return callable_obj(*props, **additional_args)\n   File \"/b/s/w/ir/kitchen-checkout/build_limited_scripts_slave/recipes/lorenz/graph_data.py\", line 133, in RunSteps\n     api.depot_tools.dirmd_path,\n AttributeError: \u0027DepotToolsApi\u0027 object has no attribute \u0027dirmd_path\u0027",
      "parentUuid": "9e4b263c_ed4624be",
      "revId": "05ee22c63669f86e673b1f396e7d91c29ef2af7e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f85a909e_5e2124b5",
        "filename": "recipes/recipe_modules/depot_tools/api.py",
        "patchSetId": 1
      },
      "lineNbr": 56,
      "author": {
        "id": 1114919
      },
      "writtenOn": "2021-01-28T22:59:28Z",
      "side": 1,
      "message": "This part is wrong:\n   led edit-recipe-bundle | led edit-cr-cl https://chromium-review.googlesource.com/c/chromium/tools/depot_tools/+/2644827 \n\nled edit-cr-cl \u003cX\u003e is about simulating a build which CQ would have triggered on \u003cX\u003e. So, remove this part.\n\nUse -O flag for edit-recipe-bundle \n(led 2\u003e\u00261 | grep -A3 -B3 \u0027O recipe_engine\u0027)\nsmth like:\n   led edit-recipe-bundle -O depot_tools\u003d/path/to/your/depot_tools/checkout/with/this/patch",
      "parentUuid": "924cfb88_eebb65c5",
      "revId": "05ee22c63669f86e673b1f396e7d91c29ef2af7e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}