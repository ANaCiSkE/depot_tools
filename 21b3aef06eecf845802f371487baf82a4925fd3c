{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "03124139_d5d94a53",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1377971
      },
      "writtenOn": "2024-06-05T17:02:34Z",
      "side": 1,
      "message": "Will this work, because this is itself a python script. I\u0027m guessing python will read the env and make its decision about whether or not to write bytecode before the env changes in this script take place.",
      "revId": "21b3aef06eecf845802f371487baf82a4925fd3c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "39c5fab3_b58dd7a0",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1128941
      },
      "writtenOn": "2024-06-05T17:16:34Z",
      "side": 1,
      "message": "Since autoninja is one of the first commands we expect users to run, can we ask users to export PYTHONDONTWRITEBYTECODE\u003d1 or set PYTHONPYCACHEPREFIX when we detect we\u0027re in /google/cog?\n\nIf we fix this for the build but people can still write pyc files for manual commands after and we still have a problem.",
      "revId": "21b3aef06eecf845802f371487baf82a4925fd3c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ba53e1a7_268b031b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1377971
      },
      "writtenOn": "2024-06-05T18:26:45Z",
      "side": 1,
      "message": "Unresolving. Also would be good to add a comment in the code similar to the commit message to explain the reasoning.",
      "parentUuid": "03124139_d5d94a53",
      "revId": "21b3aef06eecf845802f371487baf82a4925fd3c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "624b131f_14492e04",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1516592
      },
      "writtenOn": "2024-06-05T19:31:59Z",
      "side": 1,
      "message": "This is also a valid concern imo. If you run something like `bootstrap_env` from a non-Cog copy of depot tools on a dev\u0027s host machine, you may be able to avoid this issue. (Idk about browser, but OS devs install a copy of `depot_tools` outside the source checkout and add that to the host machine\u0027s path; see [this part of the developer guide](https://www.chromium.org/chromium-os/developer-library/guides/development/developer-guide/#install-depot_tools).)",
      "parentUuid": "39c5fab3_b58dd7a0",
      "revId": "21b3aef06eecf845802f371487baf82a4925fd3c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d7d322bc_52bc918a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1516592
      },
      "writtenOn": "2024-06-05T19:31:59Z",
      "side": 1,
      "message": "This is the behavior I\u0027d expect as well. CrOS uses wrappers in depot_tools that call `os.exec` or some variant, which is why we\u0027ve been able to set these env vars in our wrappers. I\u0027d expect this to be ineffective without a similar pattern, and it looks like you\u0027re importing `ninja` modules and calling `ninja.main()` directly, so I suspect this won\u0027t WAI.",
      "parentUuid": "ba53e1a7_268b031b",
      "revId": "21b3aef06eecf845802f371487baf82a4925fd3c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6c3f81ef_d44c66de",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1377971
      },
      "writtenOn": "2024-06-05T20:02:38Z",
      "side": 1,
      "message": "If this blocks use of autoninja, it\u0027s good for people who are immediately going to use other python scripts, but a hassle for (the majority of, I suspect) people who only use autoninja. However, without Erik\u0027s idea, (correct me if I\u0027m wrong) every python script in the repo would need a wrapper, due to the chicken/egg problem we\u0027re discussing in the other thread, right?",
      "parentUuid": "624b131f_14492e04",
      "revId": "21b3aef06eecf845802f371487baf82a4925fd3c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "548a3e00_c0c56088",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1377971
      },
      "writtenOn": "2024-06-05T20:02:38Z",
      "side": 1,
      "message": "This CL is still a good stepping stone to land imo. Less pyc files is better than tons of pyc files.",
      "parentUuid": "d7d322bc_52bc918a",
      "revId": "21b3aef06eecf845802f371487baf82a4925fd3c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7e2cf253_99f94624",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1001939
      },
      "writtenOn": "2024-06-06T00:13:12Z",
      "side": 1,
      "message": "which will do this\u003e when we detect we\u0027re in /google/cog\n?",
      "parentUuid": "6c3f81ef_d44c66de",
      "revId": "21b3aef06eecf845802f371487baf82a4925fd3c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e26ac43f_09cde8ff",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1001939
      },
      "writtenOn": "2024-06-06T00:13:12Z",
      "side": 1,
      "message": "note: autoninja.py in depot_tools, and I don\u0027t see any autoninja.pyc in depot_tools?",
      "parentUuid": "548a3e00_c0c56088",
      "revId": "21b3aef06eecf845802f371487baf82a4925fd3c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "156873d5_fdcada86",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1128941
      },
      "writtenOn": "2024-06-06T03:59:37Z",
      "side": 1,
      "message": "ukai:\nThis CL will only export PYTHONDONTWRITEBYTECODE for the autoninja process and child processes and once autoninja exits their shell won\u0027t have it. I\u0027m not sure what your question is, though.\n\nguterman:\nMaybe it can be a warning in red as the last output line of autoninja execution?\n\nzland:\nWe also ask people to install depot_tools in $HOME and add it to their $PATH. I don\u0027t know what bootstrap_env is though; is that something you already run or a hypothetical?",
      "parentUuid": "7e2cf253_99f94624",
      "revId": "21b3aef06eecf845802f371487baf82a4925fd3c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "56a672d3_ade50374",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1001939
      },
      "writtenOn": "2024-06-06T04:01:31Z",
      "side": 1,
      "message": "you said \"can we ask users to export PYTHONDONTWRITEBYTECODE\u003d1 or set PYTHONPYCACHEPREFIX when we detect we\u0027re in /google/cog?\"\n\nwhat do you mean \"when we detect\" here?\nThis CL is just for build process (i.e. autoninja), not solution for all.",
      "parentUuid": "156873d5_fdcada86",
      "revId": "21b3aef06eecf845802f371487baf82a4925fd3c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "88cd7d2c_5f15fd9f",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1560543
      },
      "writtenOn": "2024-06-06T15:56:16Z",
      "side": 1,
      "message": "If we are concerns about misc scripts, we can require setting this envvar as part of the onboarding process. Alternatives are handling it at some higher level, but not as high as rc files.",
      "parentUuid": "56a672d3_ade50374",
      "revId": "21b3aef06eecf845802f371487baf82a4925fd3c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "25a64492_49ac5aca",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1377971
      },
      "writtenOn": "2024-06-06T17:38:09Z",
      "side": 1,
      "message": "Our extension doesn\u0027t get the user\u0027s .bashrc/.zshrc-augmented $PATH, as it doesn\u0027t execute commands in a shell.",
      "parentUuid": "88cd7d2c_5f15fd9f",
      "revId": "21b3aef06eecf845802f371487baf82a4925fd3c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}